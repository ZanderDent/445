<!-- templates/drive.html -->
{% extends "base.html" %}
{% block title %}Project Files ‚Äî Google Drive{% endblock %}

{% block extra_head %}
<style>
    /* ---------- PAGE LAYOUT ---------- */
    .drive-page{
    max-width:1200px;
    margin:1.2rem auto;
    padding:0 .75rem;
    }

    /* ---------- HEADER ---------- */
    .drive-head{
    background:
        radial-gradient(900px 300px at 0% 0%, rgba(0,209,178,.12), transparent 60%),
        radial-gradient(800px 260px at 120% 0%, rgba(59,130,246,.10), transparent 60%),
        var(--panel);
    border:var(--line);
    border-radius:var(--radius);
    padding:clamp(1rem,2.2vw,1.35rem);
    margin-bottom:1rem;
    box-shadow:0 10px 28px rgba(0,0,0,.20);
    }
    .drive-head h1{
    margin:0 0 .35rem;
    font-size:clamp(1.55rem,2.8vw,2rem);
    letter-spacing:.2px;
    }
    .drive-head .muted{ color:var(--muted); }

    /* ---------- TOOLBAR ---------- */
    .bar{
    display:flex;
    flex-wrap:wrap;
    gap:.6rem;
    align-items:center;
    margin-top:.85rem;
    }

    #flip-entry-title{
        color: #fff;
    }

    /* Pills */
    .btn-pill{
    display:inline-flex;
    gap:.48rem;
    align-items:center;
    border:var(--line);
    background:#0b1220;
    color:#e5e7eb;
    border-radius:999px;
    padding:.48rem .85rem;
    box-shadow:0 2px 10px rgba(0,0,0,.15);
    transition:transform .12s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
    }
    .btn-pill:hover{
    transform:translateY(-1px);
    box-shadow:0 10px 24px rgba(0,0,0,.28);
    }
    .btn-pill:active{
    transform:translateY(0);
    }
    .btn-pill[aria-pressed="true"]{
    background:linear-gradient(90deg,#00d4b4,#22c55e);
    color:#051015;
    border-color:transparent;
    font-weight:800;
    }
    .btn-pill:focus-visible{
    outline:2px solid #22c55e;
    outline-offset:2px;
    box-shadow:0 0 0 4px rgba(34,197,94,.15), 0 10px 24px rgba(0,0,0,.28);
    }

    /* ---------- EMBED WRAPPER ---------- */
    .frame-wrap{
    background:var(--bg-soft,#0b1220);
    border:var(--line,1px solid #243244);
    border-radius:14px;
    overflow:hidden;
    box-shadow:0 14px 36px rgba(0,0,0,.25);
    }

    /* iframe sizing: tall on desktop, comfy on mobile */
    .frame{
    width:100%;
    height:min(78vh, 900px);
    border:0;
    display:block;
    }
    @media (max-width:980px){
    .frame{ height:72vh; }
    }
    @media (max-width:720px){
    .frame{ height:64vh; }
    }

    /* ---------- TIP BOX ---------- */
    .tips{
    margin-top:1rem;
    background:#0b1220;
    border:var(--line,1px solid #243244);
    border-left:4px solid var(--accent,#f59e0b);
    border-radius:12px;
    padding:.85rem 1rem;
    color:#cbd5e1;
    box-shadow:0 8px 22px rgba(0,0,0,.2);
    }
    .tips strong{ color:#e5e7eb; }

    /* ---------- ACCESSIBILITY / POLISH ---------- */
    @media (prefers-reduced-motion:reduce){
    .btn-pill,
    .btn-pill:hover{ transition:none; transform:none; }
    }
                        
</style>
{% endblock %}

{% block content %}
<section class="drive-page">
  <div class="drive-head">
    <h1 style="margin:0 0 .25rem">Project Files</h1>
    <p class="muted" style="margin:0">
      Browse shared documents, drawings, and exports. You can switch between <strong>Grid</strong> and <strong>List</strong> views below.
      (If something doesn‚Äôt load, open the folder directly in Drive.)
    </p>
    <div class="bar">
      <!-- View toggles -->
      <button id="btn-grid" class="btn-pill" aria-pressed="true">üü© Grid</button>
      <button id="btn-list" class="btn-pill" aria-pressed="false">üìÑ List</button>

      <!-- Open in Drive -->
      <a id="openDrive" class="btn-pill" href="https://drive.google.com/drive/folders/13-EPpJMhM_D1-M6jrzEHf1Z02P_vDksP" target="_blank" rel="noopener">
        üîó Open in Drive
      </a>
    </div>
  </div>

  <div class="frame-wrap">
    <!-- Embed: change #grid ‚áÑ #list via buttons -->
    <iframe id="driveFrame"
      class="frame"
      src="https://drive.google.com/embeddedfolderview?id=13-EPpJMhM_D1-M6jrzEHf1Z02P_vDksP#grid"
      allow="fullscreen"
      loading="lazy"
      title="Embedded Google Drive folder">
    </iframe>
  </div>

  <div class="tips">
    <strong>Tip:</strong> If you see a ‚ÄúYou need access‚Äù message, the folder‚Äôs sharing must be set to
    <em>Anyone with the link ‚Üí Viewer</em> in Google Drive.
  </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
(function(){
  const FOLDER_ID = '13-EPpJMhM_D1-M6jrzEHf1Z02P_vDksP';
  const frame = document.getElementById('driveFrame');
  const btnGrid = document.getElementById('btn-grid');
  const btnList = document.getElementById('btn-list');

  function setView(view){
    const base = `https://drive.google.com/embeddedfolderview?id=${FOLDER_ID}`;
    frame.src = `${base}#${view}`;
    btnGrid.setAttribute('aria-pressed', view === 'grid');
    btnList.setAttribute('aria-pressed', view === 'list');
    try{ localStorage.setItem('driveView', view); }catch(e){}
  }

  // Restore last view
  let view = 'grid';
  try{
    const v = localStorage.getItem('driveView');
    if (v === 'list' || v === 'grid') view = v;
  }catch(e){}
  setView(view);

  btnGrid.addEventListener('click', ()=> setView('grid'));
  btnList.addEventListener('click', ()=> setView('list'));
})();
</script>
{% endblock %}
