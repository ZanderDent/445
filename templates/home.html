{% extends "base.html" %}
{% block title %}Home — Tsolum River Bridge{% endblock %}

{% block extra_head %}
<style>
  /* ------------ HERO ------------ */
  .home-hero{
    position:relative;
    border:var(--line);
    border-radius:var(--radius);
    padding:clamp(1.3rem,3vw,2.2rem);
    margin:1rem 0 1.25rem;
    background:
      radial-gradient(1100px 420px at 0% 0%, rgba(0,209,178,.12), transparent 60%),
      radial-gradient(800px 360px at 120% 0%, rgba(59,130,246,.10), transparent 60%),
      var(--bg-soft);
    overflow:hidden;
    isolation:isolate;
  }
  .hero-badge{
    position:absolute; top:-5px; right:-5px;
    background:linear-gradient(135deg, #22c55e, #00d1b2);
    color:#0b0f1a; font-weight:800; letter-spacing:.3px;
    padding:.35rem .6rem; border-radius:999px; font-size:.78rem;
    border:1px solid rgba(255,255,255,.18);
    box-shadow:0 6px 18px rgba(0,0,0,.25);
  }
  .home-hero h1{
    margin:0 0 .5rem;
    font-size:clamp(1.7rem, 3.2vw, 2.3rem);
    letter-spacing:.2px;
  }
  .home-hero p{ margin:.2rem 0 0; color:var(--muted); max-width:68ch; }
  .hero-actions{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.9rem; }
  .btn.glow{
    position:relative; overflow:hidden;
  }
  .btn.glow:after{
    content:""; position:absolute; inset:0; pointer-events:none;
    background:linear-gradient(120deg, transparent, rgba(255,255,255,.28), transparent);
    transform:translateX(-100%);
    transition:transform .6s ease;
    mix-blend-mode:overlay;
  }
  .btn.glow:hover:after{ transform:translateX(100%); }
  .hero-bg-shape{
    position:absolute; inset:-20% -10% auto auto; width:55vw; height:55vw; max-width:780px; max-height:780px;
    background:radial-gradient(closest-side, rgba(0,209,178,.09), transparent);
    filter:blur(10px); z-index:-1;
    animation:floaty 12s ease-in-out infinite;
  }

  /* ------------ STATS ------------ */
  .stats{
    display:grid; gap:.75rem; margin-top:1rem;
    grid-template-columns:repeat(3, minmax(0,1fr));
  }
  .stat{
    background:#0b1220; border:var(--line); border-radius:12px; padding:.8rem;
  }
  .stat small{ color:var(--muted); display:block; margin-bottom:.15rem; }
  .stat .value{ font-size:1.15rem; font-weight:800; letter-spacing:.25px; }

  /* ------------ TEAM ------------ */
  .team{
    background:var(--bg-soft);
    border:var(--line);
    border-radius:var(--radius);
    padding:clamp(.9rem,2.2vw,1.2rem);
  }
  .team h2{ margin:0 0 .6rem; }
  .team-figure{ margin:0 0 .85rem; border-radius:12px; overflow:hidden; border:var(--line); background:#0b1220; }
  .team-figure img{ display:block; width:100%; height:auto; }
  .team-figure figcaption{ padding:.55rem .75rem; font-size:.9rem; color:var(--muted); border-top:var(--line); }

  .team-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));
    gap:clamp(.75rem,2vw,1rem);
  }
  .member{
    display:grid; grid-template-columns:72px 1fr; gap:.85rem; align-items:center;
    background:#0b1220; border:var(--line); border-radius:12px; padding:.8rem;
    transition:transform .12s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .member:hover{ transform:translateY(-2px); box-shadow:var(--shadow); border-color:#2b3b57; }
  .avatar{
    width:72px; height:72px; border-radius:50%;
    display:grid; place-items:center; font-weight:800; font-size:20px; letter-spacing:.3px; color:#061318;
    background:
      radial-gradient(85% 85% at 30% 25%, rgba(255,255,255,.10), transparent 60%),
      linear-gradient(135deg, #0ea5e9 0%, #22c55e 100%);
    border:var(--line);
    user-select:none;
  }
  .member h3{ margin:0; font-size:1.05rem; }
  .member p{ margin:.2rem 0 0; color:var(--muted); font-size:.92rem; }

  /* ------------ CTA CARDS ------------ */
  .cta-grid{
    display:grid; gap:1rem; margin-top:1rem;
    grid-template-columns:repeat(3, minmax(0,1fr));
  }
  @media (max-width:980px){ .cta-grid{ grid-template-columns:repeat(2, minmax(0,1fr)); } }
  @media (max-width:700px){ .cta-grid{ grid-template-columns:1fr; } }
  .cta{
    position:relative; overflow:hidden;
    background:var(--bg-soft); border:var(--line); border-radius:var(--radius);
    padding:1rem;
  }
  .cta h3{ margin:.1rem 0 .4rem; }
  .cta p{ margin:.2rem 0 .8rem; color:var(--muted); }
  .cta .pulse{
    position:absolute; inset:auto -30% -40% auto; width:60%; aspect-ratio:1/1; border-radius:50%;
    background:radial-gradient(closest-side, rgba(0,209,178,.12), transparent);
    filter:blur(8px);
    animation:breath 9s ease-in-out infinite;
    pointer-events:none;
  }

  /* ------------ fun but subtle ------------ */
  @keyframes floaty{ 0%{transform:translateY(0)} 50%{transform:translateY(-6px)} 100%{transform:translateY(0)} }
  @keyframes breath{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.08)} }
  @media (prefers-reduced-motion:reduce){
    .hero-bg-shape,.cta .pulse{ animation:none }
  }
</style>
{% endblock %}

{% block content %}
<section class="home-hero">
  <span class="hero-badge">Capstone 2025</span>
  <div class="hero-bg-shape" aria-hidden="true"></div>

  <h1>Tsolum River Bridge Proposal: The Bridgeworks Collective</h1>
  <p>
    We’re a CIVL 445/446 group advancing concept and detailed design options for a multi-use crossing
    to reconnect the One Spot Trail over the Tsolum River (Comox Valley). Work is supported by ISL.
  </p>

  <div class="hero-actions">
    <a class="btn primary glow" href="/">Open Timeline</a>
    <a class="btn secondary glow" href="/survey">Take the Concept Survey</a>
    <a class="btn glow" style="border-color:#22c55e;color:#22c55e" href="/budget">View Budget Breakdown</a>
  </div>

  <div class="stats" aria-label="Project quick facts">
    <div class="stat"><small>Start</small><div id="stat-start" class="value">—</div></div>
    <div class="stat"><small>Target Finish</small><div id="stat-end" class="value">—</div></div>
    <div class="stat"><small>Total Duration</small><div id="stat-days" class="value">—</div></div>
  </div>
</section>

<section class="team">
  <h2>Meet the Team</h2>

  <figure class="team-figure">
    <img src="{{ url_for('static', filename='team.jpg') }}" alt="Team photo" loading="lazy">
    <figcaption>
      Left → right: Luke Winnig, Ahnaf Chowdhury, Diego Boilley, Felix Stewart, Zander Dent, Gabriel Comla.
    </figcaption>
  </figure>

  <div class="team-grid" aria-label="Team roster">
    <article class="member">
      <div class="avatar" aria-hidden="true">LW</div>
      <div><h3>Luke Winnig</h3><p>Capstone Team Member</p></div>
    </article>
    <article class="member">
      <div class="avatar" aria-hidden="true">AC</div>
      <div><h3>Ahnaf Chowdhury</h3><p>Capstone Team Member</p></div>
    </article>
    <article class="member">
      <div class="avatar" aria-hidden="true">DB</div>
      <div><h3>Diego Boilley</h3><p>Capstone Team Member</p></div>
    </article>
    <article class="member">
      <div class="avatar" aria-hidden="true">FS</div>
      <div><h3>Felix Stewart</h3><p>Capstone Team Member</p></div>
    </article>
    <article class="member">
      <div class="avatar" aria-hidden="true">ZD</div>
      <div><h3>Zander Dent</h3><p>Capstone Team Member</p></div>
    </article>
    <article class="member">
      <div class="avatar" aria-hidden="true">GC</div>
      <div><h3>Gabriel Comla</h3><p>Capstone Team Member</p></div>
    </article>
  </div>

  <div class="cta-grid">
    <div class="cta">
      <span class="pulse" aria-hidden="true"></span>
      <h3>Interactive Schedule</h3>
      <p>Browse all phases, deliverables, and milestones on the timeline.</p>
      <a class="btn primary glow" href="/">Open Timeline</a>
    </div>
    <div class="cta">
      <span class="pulse" aria-hidden="true"></span>
      <h3>Have a Say</h3>
      <p>Vote for the bridge concept that best fits the site and community.</p>
      <a class="btn secondary glow" href="/survey">Take the Survey</a>
    </div>
    <div class="cta">
      <span class="pulse" aria-hidden="true"></span>
      <h3>Budget Overview</h3>
      <p>See the fee breakdown for our selected cable-stayed option.</p>
      <a class="btn glow" style="border-color:#22c55e;color:#22c55e" href="/budget">View Budget</a>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
  // Fill quick stats from schedule.json when available
  (async () => {
    try{
      const urls=['/api/schedule.json','/schedule.json','{{ url_for("static", filename="schedule.json") }}'];
      let data=null;
      for (const u of urls){ const r=await fetch(u,{cache:'no-store'}).catch(()=>null); if(r && r.ok){ data=await r.json(); break; } }
      if(!data) return;

      const start = data.start || '';
      const finish = data.finish || '';
      const s=new Date(start), f=new Date(finish);
      const days = (isFinite(s) && isFinite(f)) ? Math.round((f-s)/86400000)+1 : null;

      document.getElementById('stat-start').textContent = start || '—';
      document.getElementById('stat-end').textContent   = finish || '—';
      document.getElementById('stat-days').textContent  = days ? `${days} days` : '—';
    }catch(e){ /* silent */ }
  })();
</script>
{% endblock %}
